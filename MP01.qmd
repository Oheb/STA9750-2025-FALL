---
title: "Mini Project 1 – Netflix Top 10"
author: "Daniel Ohebshalom"
date: "09-24-2025"
format: 
  html:
    code-fold: true
    theme: sandstone
    toc: true
---

# Introduction to the project
This project has 2 datasets, One for the top ten shows of each country tracked (Country_Top 10) and the Top ten overall shows Globally (Global_Top_10), the analyses below help us interpret various facets about the data

# Loading the Packages and the Datasets
```{r}
# Load required packages
suppressPackageStartupMessages({
  library(tidyverse)
  library(readr)
  library(dplyr) 
  library(knitr)
  library(DT)
  library(stringr)
  library(glue)
  library(lubridate)
})

if(!dir.exists(file.path("data", "mp01"))){
    dir.create(file.path("data", "mp01"), showWarnings=FALSE, recursive=TRUE)
}

GLOBAL_TOP_10_FILENAME <- file.path("data", "mp01", "global_top10_alltime.csv")

if(!file.exists(GLOBAL_TOP_10_FILENAME)){
    download.file("https://www.netflix.com/tudum/top10/data/all-weeks-global.tsv", 
                  destfile=GLOBAL_TOP_10_FILENAME)
}

COUNTRY_TOP_10_FILENAME <- file.path("data", "mp01", "country_top10_alltime.csv")

if(!file.exists(COUNTRY_TOP_10_FILENAME)){
    download.file("https://www.netflix.com/tudum/top10/data/all-weeks-countries.tsv", 
                  destfile=COUNTRY_TOP_10_FILENAME)
}


# Importing of Datasets for Analysis

GLOBAL_TOP_10 <- read_tsv(GLOBAL_TOP_10_FILENAME)
COUNTRY_TOP_10 <- read_tsv(COUNTRY_TOP_10_FILENAME)


# Read - tell read_tsv to treat "N/A" as NA

GLOBAL_TOP_10  <- readr::read_tsv(GLOBAL_TOP_10_FILENAME,  na = c("N/A"))
COUNTRY_TOP_10 <- readr::read_tsv(COUNTRY_TOP_10_FILENAME, na = c("N/A"))
```

# Task 1: Data Acqusition; a quick look of the datasets we are working with
```{r}

GLOBAL_TOP_10 <- GLOBAL_TOP_10 %>%
  mutate(season_title = na_if(season_title, "N/A"))

COUNTRY_TOP_10 <- COUNTRY_TOP_10 %>%
  mutate(season_title = na_if(season_title, "N/A"))

# To Confirm
glimpse(GLOBAL_TOP_10)
glimpse(COUNTRY_TOP_10)
```

# Task 2: Data Cleaning
```{r}
GLOBAL_TOP_10 <- GLOBAL_TOP_10 %>%
  mutate(runtime_minutes = round(60 * runtime))

str(GLOBAL_TOP_10)
glimpse(GLOBAL_TOP_10)
```

# Task 3: Data Import & Interpretation
```{r}
COUNTRY_TOP_10
GLOBAL_TOP_10

# Initial Data Exploration and Adjustments

GLOBAL_TOP_10 |> 
    head(n=20) |>
    datatable(options=list(searching=FALSE, info=FALSE))

format_titles <- function(df){
    colnames(df) <- str_replace_all(colnames(df), "_", " ") |> str_to_title()
    df
}

#Formating of Data

GLOBAL_TOP_10 |> 
    format_titles() |>
    head(n=20) |>
    datatable(options=list(searching=FALSE, info=FALSE)) |>
    formatRound(c('Weekly Hours Viewed', 'Weekly Views'))

GLOBAL_TOP_10 |> 
    select(-season_title) |>
    format_titles() |>
    head(n=20) |>
    datatable(options=list(searching=FALSE, info=FALSE)) |>
    formatRound(c('Weekly Hours Viewed', 'Weekly Views'))

GLOBAL_TOP_10 |> 
    mutate(`runtime_(minutes)` = round(60 * runtime)) |>
    select(-season_title, 
           -runtime) |>
    format_titles() |>
    head(n=20) |>
    datatable(options=list(searching=FALSE, info=FALSE)) |>
    formatRound(c('Weekly Hours Viewed', 'Weekly Views'))
```

# Task 4: Exploratory and Press Release Questions: 

# Countries Netflix operates in:
```{r}
COUNTRY_TOP_10 %>% distinct(country_name) %>% count()
```

# Non English Film with the most cumulative weeks in the global top ten:
```{r}
GLOBAL_TOP_10 %>%
  filter(category == "Films (Non-English)") %>%
  group_by(show_title) %>%
  summarise(weeks_in_top10 = n_distinct(week), .groups = "drop") %>%
  arrange(desc(weeks_in_top10)) %>%
  slice(1)
```
# Longest Film in global top 10
```{r}
GLOBAL_TOP_10 %>%
  filter(str_detect(category, "Films")) %>%
  mutate(runtime_min = round(60 * runtime)) %>%
  arrange(desc(runtime_min)) %>% slice(1) %>%
  select(show_title, runtime_min)
```
# Programs with most total hours per the four catagories
```{r}
GLOBAL_TOP_10 %>%
  group_by(category, show_title) %>%
  summarise(total_hours = sum(weekly_hours_viewed, na.rm = TRUE), .groups = "drop_last") %>%
  slice_max(total_hours, n = 1, with_ties = FALSE) %>%
  arrange(category)
```

# TV Show with the Longest Run in a country's Top 10:
```{r}
COUNTRY_TOP_10 %>%
  group_by(country_name, show_title) %>%
  summarise(weeks = n_distinct(week), .groups = "drop") %>%
  arrange(desc(weeks)) %>%
  slice(1)
```

# Country with fewer than 200 weeks recorded and the date it stopped:
```{r}  
  COUNTRY_TOP_10 %>%
  group_by(country_name) %>%
  summarise(n_weeks = n_distinct(week),
            last_week = max(week, na.rm = TRUE)) %>%
  filter(n_weeks < 200)
```

# Total Viewership of Squid Game Across All Seasons:
```{r}
  GLOBAL_TOP_10 %>%
  filter(str_detect(show_title, regex("Squid Game", ignore_case=TRUE))) %>%
  summarise(total_hours = sum(weekly_hours_viewed, na.rm = TRUE))
```

# Approx Red Notice Views in 2021: 
```{r}
GLOBAL_TOP_10 %>%
  filter(show_title == "Red Notice", year(week) == 2021) %>%
  summarise(total_hours = sum(weekly_hours_viewed, na.rm = TRUE))
```

# Films that reached #1 but did not debut at the #1 spot (List below):
```{r}
us <- COUNTRY_TOP_10 %>% filter(country_name == "United States", str_detect(category, "Film"))
debuts <- us %>% arrange(week) %>% group_by(show_title) %>% slice(1) %>% select(show_title, debut_rank = weekly_rank)
ever_number1 <- us %>% group_by(show_title) %>% summarise(ever1 = any(weekly_rank == 1))
left_join(debuts, ever_number1, by = "show_title") %>%
  filter(debut_rank > 1, ever1)
```

# TV show that hit the top 10 in the most countries in its debuting week (see below)
```{r}
COUNTRY_TOP_10 %>%
  group_by(show_title, season_title, country_name) %>%
  summarise(first_week_in_country = min(week), .groups = "drop") %>%
  group_by(show_title, season_title) %>%
  summarise(first_debut_week = min(first_week_in_country),
            n_countries_at_debut = n_distinct(country_name),
            .groups = "drop") %>%
  arrange(desc(n_countries_at_debut)) %>%
  slice(1)
```
  
  
  
# Press Release 1: Stranger Things   
```{r}
library(dplyr)
library(lubridate)


GLOBAL_TOP_10 %>%
  filter(str_detect(show_title, "Stranger Things")) %>%
  summarise(total_hours = sum(weekly_hours_viewed, na.rm = TRUE))
```

After four breakthrough seasons that redefined the culture surrounding original programming on Netflix, the critically acclaimed Stranger Things is gearing up for its fifth and final season at the end of 2025. In its most recent season, which was released between May and July 2022, the drama-filled horror show accumulated nearly 2 billion viewing hours on Netflix platforms, rising to the top of the ranks during that period for nearly half the year in total global viewership. Throughout its distinguished run, Stranger Things has accumulated approximatley 2,967,980,000 viewing hours since its release in July 2016, putting it at the top of Netflix’s original series and leading the English TV Category. Though in a close battle with Wednesday, another popular show in Netflix’s English market that was released in 2022, Stranger Things has nonetheless maintained its stance as perhaps Netflix’s most  culturally significant English show over the last decade, and its fans are anxiously awaiting the conclusion of its mind bending and emotional story.

# Press Release 2: Indian Viewership
```{r}
library(dplyr)

  COUNTRY_TOP_10 %>%
  filter(country_name == "India") %>%
  group_by(show_title) %>%
  summarise(total_weeks_in_top10 = sum(cumulative_weeks_in_top_10, na.rm = TRUE)) %>%
  arrange(desc(total_weeks_in_top10)) %>%
  slice(1:5)
```

As the second largest country in the world by population and the market Netflix truly wants to capitalize on, India stands out among other nations the Streaming App operates in as truly a unique story of success. Since our data began tracking in 2021, the Indian Market has seen over 1000 unique titles appear in global top ten charts, with many programs appearing despite having little to no presence elsewhere in the world, especially in Netflix’s largest market: The United States. After Observing the Trends in the given data, we can see that Netflix’s content diversity and viewership has increased significantly over time, with 39 different shows appearing each week in the top ten. With an estimated growing customer base of over 30 million, India is far outpacing most of the world in terms of subscriber growth and pure numbers. Recently, with international top shows such as Squid Game as well as India’s top domestic programs such as Dabba Cartel and Saare Jahan Se Accha: The Silent Guardians leading charts for multiple weeks, it seems that Netflix will only grow in this massive market with many producers signing exclusive rights with the platform, such as the Great Indian Kapil Show. Additionally, the Hindu Language shows of Netflix are also seeing a rise in viewership globally largely as a result of Netlfix's success in India, just going to show how impactful and influential this market is to Netflix's global success


# Press Release 3: The global dominace of Squid Game
```{r}
library(dplyr)
library(stringr)
library(lubridate)
# Filter for Squid Game only
squid_data <- GLOBAL_TOP_10 %>%
  filter(str_detect(show_title, "Squid Game"))
# 1. Overall stats
overall_stats <- squid_data %>%
  summarise(
    total_weeks = n_distinct(week),
    avg_weekly_viewers = mean(weekly_views, na.rm = TRUE)
  )
# 2. Season-by-season stats
season_stats <- squid_data %>%
  group_by(season_title) %>%
  summarise(
    avg_weekly_viewers = mean(weekly_views, na.rm = TRUE),
    total_weeks = n_distinct(week)
  ) %>%
  arrange(season_title)
# 3. Combine seasons + overall into one table
final_summary <- bind_rows(
  season_stats,
  tibble(season_title = "Overall", 
         avg_weekly_viewers = overall_stats$avg_weekly_viewers, 
         total_weeks = overall_stats$total_weeks)
)
# Display nicely
print(final_summary)
```
          
Since its release in September 2021, Hwang Dong-hyuk’s game show Squid Game has taken over the world by storm, leading global charts and positioning itself as a global cultural phenomenon. Throughout its 3 seasons, the show has averaged a remarkable 11340000 weekly viewers when it has cracked the global top ten weekly rankings through an equally impressive 50 week presence in the global top ten over the last 5 years. Individually, while the the Korean game show’s first season was undisputedly the peak of the franchise, averaging 4,416,667 weekly views during its peak season, the following seasons were still potent leaders in global viewships, albeit in shorter periods due to a shorter hiatus span of 1 year compared to 3 and global pandemic restrictions easing over that 3 year span, which initially allowed many Netflix subscribers to watch their shows far more frequently as more were in front of their tvs. As a whole, Netflix’s peak viewership across all shows during the data collection period was during the later half of the global pandemic (Start of data - end of 2022), which no show benefitted more from than Squid Game, as it allowed it to become one of the world’s most distinguished shows when all the eyeballs in the world wanted action following a dormant 2 years of societal isolation.

---
  
  